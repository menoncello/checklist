#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# Security: Scanning for potential secrets
echo "ğŸ”’ Scanning for potential secrets..."
if grep -rn --exclude-dir=node_modules --exclude-dir=.git \
  -E "(api[_-]?key|secret.*token.*password|AKIA[0-9A-Z]{16})" . ; then
  echo "âŒ Potential secrets detected! Please review and remove before committing."
  exit 1
fi

# TypeScript type checking
echo "ğŸ” Running TypeScript type checking..."
bun run typecheck

# Linting and formatting with lint-staged
echo "ğŸ“ Running linting and formatting..."
bunx lint-staged

echo "âœ… Pre-commit checks passed!"